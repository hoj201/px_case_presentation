<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/moon.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h3>Machine Learning for Power X - Water</h3>
					<p>Henry O. Jacobs</p>
					<p>May 28, 2021</p>
					<iframe src="https://giphy.com/embed/l0Ex3TbuoETxNAMfe" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
					<p style="font-size:12px"><a href="https://giphy.com/gifs/animation-2d-l0Ex3TbuoETxNAMfe"> animation by Amanda Bonaito</a></p>
				</section>
				<section>
					<h2>Summary</h2>
					<ul>
						<li class="fragment fade-in-then-semi-out">Calibration</li>
						<li class="fragment fade-in-then-semi-out">Plato</li>
						<li class="fragment fade-in-then-semi-out">Mediocre ideas</li>
						<li class="fragment fade-in-then-semi-out">dog detection</li>
						<li class="fragment fade-in-then-semi-out">Convolution</li>
						<li class="fragment fade-in-then-semi-out">Two-face</li>
					</ul>
				</section>
				<section>
					<section>
						<h2> Calibration</h2>
						<ol>
							<li>Press the "Calibration button" on the PowerX app </li>
							<li> Fill the PowerX provided container to fill line.</li>
							<li> Press "Done".</li>
							<li>Repeat $n$ times (perhaps with a different sized bucket)</li>
						</ol>
						<img class="r-stretch" src="images/measuring_cup.jpg">
					</section>
					<section>
						<h2>???</h2>
						<ul>
							<li>Why not have the user provide pipe-width?</li>
							<li>How much water?</li>
							<li>How many repeats?</li>
						</ul>
					</section>
					<section data-visibility="hidden">
						<h2>Sensor noise</h2>
						<ol>
							<li> Estimate standard-error of readings</li>
							<li> Randomize over devices/pipes/faucets </li>
						</ol>
						<img src="images/gammas.svg">
					</section>
				</section>
				<section>
					<h2>Inference</h2>
						<div class="r-stack">
							<img style="height:300px" class="fragment fade-in-then-out" src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Platon_Cave_Sanraedam_1604.jpg">
							<img class="r-stretch fragment fade-in-then-out" src="images/plato.svg">
							<img class="r-stretch fragment fade-in-then-out" src="images/plato_triangle.svg">
							<img class="r-stretch fragment fade-in-then-out" src="images/plato_broken.svg">
						</div>
				</section>				
				<section data-markdown>
					<textarea data-template>
						## ML @ Power X
						```json
						X = [0, 0, 22, ...], t=[datetime(year=2021...
						```

						```python
						Y = {
							"class": {"washer": 0.0, "faucet": 1.0, "dishwasher":0.0},
							"start": datetime(year=2021,
								month=5, day=24, hour=5,
								minute=23, second=3,
								timezone='UTC'),
							"end": datetime(year=2021,
								month=5, day=24, hour=5,
								minute=24, second=38,
								timezone='UTC'),
							"water-usage": 3420
						},
						...
						```
						<p style="font-size:20px"> - Windows can overlap</p>
						---
						## Consider

						- timezone (to convert from UTC)
						- location
						- weather
						- size of household

						---

						### Raw data

						![lineplot](images/powerx_lineplot.jpeg)

					</textarea>
				</section>
				<section>
					<section>
						<h2 class="r-fit-text">mediocre ideas</h2>
					</section>
					<section>
					<h2>Computer vision model </h2>

					<img src="https://i.imgur.com/5Q0aq82.jpg">
					<p>from arXiv/abs/1506.02640</p>
					</section>
					<section data-visibility="hidden">
					<h2>Spotify inspired</h2>

					<img src="images/640px-Spectrogram-19thC.png">
					<p>
						People at Spotify might know how to detect what instrument
						is playing and when.
					</p>
					</section>
					<section>
						<h2>Critiques of CV inspired models</h2>
						<ul>
							<li><p> streams are not fixed-length arrays </p></li>
							<li><p class="fragment"> might perform badly for events with variable time-scales (e.g. showers) </p></li>
							<li><p class="fragment"> hard to debug (not modular) </p></li>
						</ul>
					</section>
				</section>
				<section>
					<section>
						<h1 class="r-fit-text">Event based model</h1>
					</section>
					<section>
						<h2>Event based model</h2>
						As data arrives:
						<ol>
							<li>Detect when windows start</li>
							<ul class="fragment" ><li> Classify open-ended window </li></ul>
							<li>Detect end-times</li>
							<li>Classify the outlet type and water-usage.</li>
						</ol>
					</section>
					<section>
						<h3>Architecture</h3>
						<img class="r-fit-image" src="images/pipeline.svg">
						<!-- ideally each process should be $O(1)$ in space and time -->
					</section>
					<section>
						<h2>Start time detection</h2>
							<p>
							Consider a convolution $x \stackrel{\kappa}{\mapsto} z$
							$$
								z(t) = \kappa_0 x(t) + \kappa_1 x(t-1) + \dots + \kappa_{10} x(t-10)
							$$
						</p>
					</section>
					<section>
						<h2>Convolution</h2>
						<img src="images/convolution.svg">
					</section>
					<section>
						<h2>Open window classification</h2>
						<div class="fragment">
						<p>At each timestep, cobble a feature vector</p>
						<ul>
							<li>current window length</li>
							<li>initial jump size</li>
							<li>water consumed thus far (??)</li>
							<li>max/min/mean/variance values of convolved signal</li>
							<li> ... </li>
						</ul>
						</div>
						<p class="fragment">Then use logistic regression on $\mathbb{R}^n$.</p>
						<p class="fragment" style="font-size: small;">(or use a recurrant neural network)</p>
					</section>
					<section>
						<h2>End time detection</h2>
						<iframe class="fragment" src="https://giphy.com/embed/kGhsld1MnajNeGubZ8" width="480" height="300" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
						<p style="font-size:15px"><a href="https://giphy.com/gifs/deja-vu-dejavu-dejavuapp-kGhsld1MnajNeGubZ8">via GIPHY</a></p>
					</section>
					<section>
						<h2>Closed window detection</h2>
						<p> Same as open-window classification, but with end-time features</p>
						<iframe class="fragment" src="https://giphy.com/embed/kGhsld1MnajNeGubZ8" width="480" height="300" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
						<p style="font-size:15px"><a href="https://giphy.com/gifs/deja-vu-dejavu-dejavuapp-kGhsld1MnajNeGubZ8">via GIPHY</a></p>
					</section>

					<section>
						<h2>Overview</h2>
						<img src="images/pipeline.svg">
						<p style="font-size:20px;">(be quick)</p>
					</section>
					<section>
						<h2>Concerns</h2>
						<ul>
							<li>Overlapping windows (rarity and concurrency)</li>
							<li>Annual seasonality</li>
							<li>Regional overfit</li>
							<li>Insufficient data</li>
							<li>Cloud orchestration (edge computing?) </li>
						</ul>
					</section>
					<section>
						<h2>Otherwise...</h2>
						<img src="https://media.giphy.com/media/AhjXalGPAfJg4/giphy.gif">
					</section>
				</section>
				<section>
					<section>
						<h2>Model adaptability</h2>
						<img class="r-stretch-image" src="https://media.giphy.com/media/WDpgbGctTnxuw/giphy.gif">
						<p style="font-size:small;">Various ways to avoid retraining models</p>
					</section>
					<section data-auto-animate>
						<h2>Adding fields</h2>
						<p>A single binary field would split data into two.
							So could try training two models.
						</p>
						<p class="fragment">A single $n$-ary field would split data into $n$ components.
							So ...
						</p>
					</section>
					<section data-auto-animate>
						<h2>Adding fields</h2>
						<p class="fragment fade-in-then-semi-out">we cluster.
							<img src="images/clustering.png">
						</p>
						<p class="fragment">or just redesign the model.</p>
					</section>
					<section>
						<h2>Personalization</h2>
						<p>Example: Daily water usage</p>
						<ol class="fragment">
							<li> Monitor sample mean/variance on a sliding window</li>
							<li> Grow window until convergence (or give-up)</li>
						</ol>
						<p class="fragment">More generally, we would do Bayesian updates to a probabilistic model
							$$
								\Pr(\theta \mid x_t) = \frac{\Pr(x_t \mid \theta) \Pr(\theta) }{\Pr(x_t)} 
							$$
						</p>
					</section>
					<section data-auto-animate>
						<h2>User feedback</h2>
						<img src="images/feedback.svg">
					</section>
					<section data-auto-animate>
						<h2> User feedback </h2>
						<p>
							Imagine we have two models. We'd like to know which one is better
						</p>
						<img src="images/feedback.svg", style="width:100px">
						<p class="fragment">
							This is identical to estimating the probability 
							of flipping heads on a (biased) coin.
						</p>
					</section>
					<section>
						<h2> Coin flips</h2>
						<img src="images/smilingtwoface1.jpg">
					</section>
					<section data-auto-animate>
						<h2> Coin flips </h2>
						<p>
							If we have a coin with an unknown bias $0 \leq \theta \leq 1$
							distributed according to $\Pr(\theta) = 1$
						</p>
						<img src="images/beta/iterations_0.jpeg">
						<p class="fragment">
						 and flip the coin once.
						</p>
					</section>
					<section data-auto-animate>
						<h2> Coin flips </h2>
						<div class="r-stack">
						<p class="fragment fade-in-then-out">
							If it's heads then
							\[
								\Pr(\theta | X_0 = \text{heads}) = \theta
							\]
							<img src="images/heads.svg">
						</p>
						<p class="fragment fade-in-then-out">
							If it's tails then
							\[
								\Pr(\theta | X_0 = \text{tails}) = 1-\theta
							\]
							<img src="images/tails.svg">
						</p>
						<p class="fragment fade-in-then-out">
							After many tosses
							\[
								\Pr( \theta | N_T, N_H) = \theta^{N_T} (1-\theta)^{N_H} 
							\]
							<img src="images/beta/iterations_111.jpeg">
						</p>
						</div>
					</section>
					<section>
						<h2> Coin flips (cont) </h2>
						<div class="r-stack">
							<img class="fragment", src="images/beta/iterations_0.jpeg">
							<img class="fragment", src="images/beta/iterations_1.jpeg">
							<img class="fragment", src="images/beta/iterations_2.jpeg">
							<img class="fragment", src="images/beta/iterations_3.jpeg">
							<img class="fragment", src="images/beta/iterations_4.jpeg">
							<img class="fragment", src="images/beta/iterations_5.jpeg">
							<img class="fragment", src="images/beta/iterations_6.jpeg">
							<img class="fragment", src="images/beta/iterations_7.jpeg">
							<img class="fragment", src="images/beta/iterations_8.jpeg">
							<img class="fragment", src="images/beta/iterations_9.jpeg">
							<img class="fragment", src="images/beta/iterations_111.jpeg">
						</div>
					</section>
					<section>
						<h2> feedback </h2>
						<img src="images/feedback.svg">
					</section>
				</section>
				<section>
					<h2>Summary</h2>
					<ul>
						<li class="fragment fade-in-then-semi-out">Calibration</li>
						<li class="fragment fade-in-then-semi-out">Plato</li>
						<li class="fragment fade-in-then-semi-out">Mediocre ideas</li>
						<li class="fragment fade-in-then-semi-out">dog detection</li>
						<li class="fragment fade-in-then-semi-out">Convolution</li>
						<li class="fragment fade-in-then-semi-out">Two-face</li>
					</ul>
				</section>
				<section>
					<h1>The end</h1>
					<iframe src="https://giphy.com/embed/l0Ex3TbuoETxNAMfe" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
					<p style="font-size:15px"><a href="https://giphy.com/gifs/animation-2d-l0Ex3TbuoETxNAMfe"> Amanda Bonaito via GIPHY</a></p>
				</section>

			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/math/math.js"></script>
		<script src="plugin/spotlight/spotlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				slideNumber: true,
				hash: true,
				math: {
					mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
					config: 'TeX-AMS_HTML-full',
					TeX: {Macros: {RR: "{\\bf R}"}}
				},
				spotlight: {
					size: 100
				},
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath, RevealSpotlight]
			});
		</script>
	</body>
</html>
